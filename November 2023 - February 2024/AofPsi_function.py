# -*- coding: utf-8 -*-
"""
Created on Wed Feb 21 13:55:48 2024

@author: sstowe

Plot A(phi), the circadian modulation of the pineal gland's melatonin production

"""

import numpy as np
import matplotlib.pyplot as plt

a = 6*60#4*60 #1.0442e-3 # CHANGED, the tiny value is from Breslow
delta_M = 600/3600 # CHANGED, converting secs to hrs
r = 15.36/3600 # CHANGED, converting secs to hrs

psi_on = 2.61799 #1.0472 #6.113 CHANGED 
psi_off = 5.23598776 #3.92699 #4.352 CHANGED

psi = [4.82118,
4.84717,
4.87315,
4.89914,
4.92513,
4.95111,
4.9771,
5.00308,
5.02907,
5.05505,
5.08104,
5.10702,
5.13301,
5.15899,
5.18498,
5.21096,
5.23695,
5.26293,
5.28892,
5.3149,
5.34089,
5.36687,
5.39286,
5.41884,
5.44483,
5.47081,
5.4968,
5.52278,
5.54877,
5.57475,
5.60074,
5.62672,
5.65271,
5.67869,
5.70468,
5.73066,
5.75665,
5.78263,
5.80862,
5.8346,
5.86059,
5.88657,
5.91256,
5.93854,
5.96453,
5.99051,
6.0165,
6.04248,
6.06847,
6.09445,
6.12044,
6.14642,
6.17241,
6.19839,
6.22438,
6.25036,
6.27635,
6.30233,
6.32832,
6.3543,
6.38029,
6.40628,
6.43226,
6.45825,
6.48423,
6.51022,
6.5362,
6.56219,
6.58817,
6.61416,
6.64014,
6.66613,
6.69211,
6.7181,
6.74408,
6.77007,
6.79605,
6.82204,
6.84802,
6.87401,
6.89999,
6.92598,
6.95196,
6.97795,
7.00393,
7.02992,
7.0559,
7.08189,
7.10787,
7.13386,
7.15984,
7.18583,
7.21181,
7.2378,
7.26378,
7.28977,
7.31575,
7.34174,
7.36772,
7.39371,
7.41969,
7.44568,
7.47166,
7.49765,
7.52364,
7.54962,
7.57561,
7.60159,
7.62758,
7.65356,
7.67955,
7.70553,
7.73152,
7.7575,
7.78349,
7.80947,
7.83546,
7.86144,
7.88743,
7.91341,
7.9394,
7.96538,
7.99137,
8.01735,
8.04334,
8.06932,
8.09531,
8.12129,
8.14728,
8.17326,
8.19925,
8.22523,
8.25122,
8.2772,
8.30319,
8.32917,
8.35516,
8.38114,
8.40713,
8.43311,
8.4591,
8.48508,
8.51107,
8.53705,
8.56304,
8.58902,
8.61501,
8.641,
8.66698,
8.69297,
8.71895,
8.74494,
8.77092,
8.79691,
8.82289,
8.84888,
8.87486,
8.90085,
8.92683,
8.95282,
8.9788,
9.00479,
9.03077,
9.05676,
9.08274,
9.10873,
9.13471,
9.1607,
9.18668,
9.21267,
9.23865,
9.26464,
9.29062,
9.31661,
9.34259,
9.36858,
9.39456,
9.42055,
9.44653,
9.47252,
9.4985,
9.52449,
9.55047,
9.57646,
9.60244,
9.62843,
9.65441,
9.6804,
9.70638,
9.73237,
9.75835,
9.78434,
9.81032,
9.83631,
9.8623,
9.88828,
9.91427,
9.94025,
9.96624,
9.99222,
10.0182,
10.0442,
10.0702,
10.0962,
10.1221,
10.1481,
10.1741,
10.2001,
10.2261,
10.2521,
10.2781,
10.304,
10.33,
10.356,
10.382,
10.408,
10.434,
10.46,
10.4859,
10.5119,
10.5379,
10.5639,
10.5899,
10.6159,
10.6418,
10.6678,
10.6938,
10.7198,
10.7458,
10.7718,
10.7978,
10.8237,
10.8497,
10.8757,
10.9017,
10.9277,
10.9537,
10.9797,
11.0056,
11.0316,
]




dlmo_phase = 5*np.pi/12

A_of_psi = list()


for t in range(0,len(psi)):
    
    psi_convert = np.mod(psi[t] - dlmo_phase,2*np.pi)
    
    if psi_convert > psi_off and psi_convert <= psi_on:
        print("Pineal off")
        A = a * (1 - np.exp(-delta_M*np.mod(psi_on - psi_convert,2*np.pi))) / (1 - np.exp(-delta_M*np.mod(psi_on - psi_off,2*np.pi)))
        A_of_psi.append(A)
    else:
        print("Pineal on")
        A = a*np.exp(-r*np.mod(psi_on - psi_off,2*np.pi))
        A_of_psi.append(A)

#---------- Plot A(psi) ------------

#plt.plot(psi,A_of_psi)
#plt.title("Pineal GLand Activation")




#-------------- Take 2: Switch order of if/else statement -----------------------

dlmo_phase = 5*np.pi/12

A_of_psi = list()


for t in range(0,len(psi)):
    
    psi_convert = np.mod(psi[t] - dlmo_phase,2*np.pi)
    
    if psi_on < psi_convert < psi_off:
        print("Pineal on")
        A = a*np.exp(-r*np.mod(psi_on - psi_off,2*np.pi))
        A_of_psi.append(A)
    else:
        print("Pineal off")
        A = a * (1 - np.exp(-delta_M*np.mod(psi_on - psi_convert,2*np.pi))) / (1 - np.exp(-delta_M*np.mod(psi_on - psi_off,2*np.pi)))
        A_of_psi.append(A)


#---------- Plot A(psi) ------------

plt.plot(np.mod(psi,2*np.pi),A_of_psi)
plt.title("Pineal Gland Activation")