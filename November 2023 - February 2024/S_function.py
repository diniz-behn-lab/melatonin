# -*- coding: utf-8 -*-
"""
Created on Mon Feb  5 16:25:03 2024

@author: sstowe

Code to look closer as the S function 

"""

import numpy as np
import matplotlib.pyplot as plt

delta = 0.0075
alpha_0 = 0.05
p = 1.5
I_0 = 9325
G = 33.75

m = 7*60

H1_vector = [29.4774,
31.0397,
32.467,
33.7808,
34.9947,
36.1224,
37.1761,
38.166,
39.0997,
39.9809,
40.8136,
41.6014,
42.3483,
43.0581,
43.7316,
44.374,
44.9863,
45.5699,
46.1261,
46.6559,
47.1608,
47.6419,
48.1005,
48.5377,
48.9549,
49.3532,
49.733,
50.0954,
50.4421,
50.7736,
51.0904,
51.3931,
51.6822,
51.9581,
52.2216,
52.473,
52.7129,
52.9418,
53.1603,
53.3688,
53.568,
53.7584,
53.9404,
54.1141,
54.2801,
54.439,
54.591,
54.7364,
54.8753,
55.0081,
55.135,
55.2561,
55.3718,
55.4822,
55.5877,
55.6884,
55.7846,
55.8765,
55.9644,
56.0484,
56.1288,
56.2056,
56.2791,
56.3493,
56.4164,
56.4805,
56.5418,
56.6004,
56.6563,
56.7099,
56.7613,
42.8251,
32.2958,
24.3701,
18.3795,
13.8661,
10.4619,
7.88757,
5.952,
4.48995,
3.38706,
2.55503,
1.92789,
1.45358,
1.09685,
0.827503,
0.624009,
0.470966,
0.355171,
0.267913,
0.202195,
0.15245,
0.115031,
0.0867898,
0.0654434,
0.0493908,
0.0372509,
0.0280969,
0.0212057,
0.0159889,
0.0120637,
0.0091026,
0.00686347,
0.00517957,
0.00390694,
0.00294663,
0.00222398,
0.00167692,
0.00126516,
0.000954686,
0.000719822,
0.000543187,
0.000409905,
0.000308864,
0.000233108,
0.00017603,
0.000132665,
0.000100033,
7.55452e-05,
5.7068e-05,
4.29285e-05,
3.23182e-05,
2.44291e-05,
1.85017e-05,
1.39775e-05,
1.04928e-05,
7.87058e-06,
5.93374e-06,
4.50528e-06,
3.4191e-06,
2.58291e-06,
1.93893e-06,
1.45439e-06,
1.09653e-06,
8.32581e-07,
6.31845e-07,
4.77296e-07,
3.58288e-07,
2.68756e-07,
2.02635e-07,
1.53862e-07,
1.16764e-07,
8.81996e-08,
6.62067e-08,
4.9663e-08,
3.74462e-08,
2.84339e-08,
2.15779e-08,
1.62984e-08,
1.22341e-08,
9.17716e-09,
6.91991e-09,
5.25461e-09,
3.98757e-09,
3.01178e-09,
2.26069e-09,
1.69584e-09,
1.27877e-09,
9.71057e-10,
7.36897e-10,
5.56547e-10,
4.17744e-10,
3.13371e-10,
2.36313e-10,
1.79452e-10,
1.36178e-10,
1.02844e-10,
7.71933e-11,
5.79075e-11,
4.36698e-11,
3.3163e-11,
2.52045e-11,
1.90896e-11,
1.43125e-11,
1.06741e-11,
7.97524e-12,
6.01682e-12,
4.59972e-12,
3.52485e-12,
2.68032e-12,
2.01847e-12,
1.50805e-12,
1.12462e-12,
8.43773e-13,
6.41068e-13,
4.92082e-13,
3.73766e-13,
2.81891e-13,
2.12691e-13,
1.60422e-13,
1.21027e-13,
9.1414e-14,
6.89687e-14,
5.1853e-14,
3.90484e-14,
2.95366e-14,
2.24532e-14,
1.70622e-14,
1.27951e-14,
9.5017e-15,
7.03208e-15,
5.23622e-15,
3.9641e-15,
3.0657e-15,
2.39102e-15,
1.84251e-15,
1.40928e-15,
1.05851e-15,
7.81013e-16,
5.67577e-16,
4.09004e-16,
2.96096e-16,
2.19652e-16,
1.70473e-16,
1.39358e-16,
1.17108e-16,
9.45234e-17,
7.21014e-17,
5.43041e-17,
4.04736e-17,
3.00167e-17,
2.23403e-17,
1.68511e-17,
1.29561e-17,
1.00619e-17,
7.65431e-18,
5.7683e-18,
4.34608e-18,
3.2823e-18,
2.47708e-18,
-7.57028e-07,
5.9442,
10.8124,
14.8509,
18.2442,
21.1365,
23.6308,
25.8155,
27.7483,
29.4771]

H1 = np.array(H1_vector,dtype=float)

n_vector = [0.470169,
0.449481,
0.429703,
0.410794,
0.392717,
0.375437,
0.35892,
0.343128,
0.328027,
0.31359,
0.29979,
0.286599,
0.273989,
0.261934,
0.250424,
0.239409,
0.228871,
0.218792,
0.209156,
0.199945,
0.191141,
0.182729,
0.17469,
0.167007,
0.159663,
0.152642,
0.145939,
0.139534,
0.133399,
0.127526,
0.121907,
0.116532,
0.111393,
0.106481,
0.101787,
0.0973021,
0.0930179,
0.0889254,
0.0850159,
0.0812805,
0.0777104,
0.0742968,
0.071031,
0.0679141,
0.0649321,
0.0620765,
0.0593431,
0.0567279,
0.0542266,
0.0518351,
0.0495494,
0.0473653,
0.0452787,
0.0432853,
0.0413812,
0.0395621,
0.037824,
0.0361627,
0.0345741,
0.033054,
0.0316001,
0.0302096,
0.02888,
0.0276088,
0.0263937,
0.0252323,
0.0241222,
0.023061,
0.0220463,
0.0210762,
0.020147,
0.116859,
0.199931,
0.271241,
0.332492,
0.385079,
0.430231,
0.469019,
0.502312,
0.530902,
0.556055,
0.624042,
0.675569,
0.714732,
0.744362,
0.766839,
0.783905,
0.796828,
0.806633,
0.814066,
0.819697,
0.823972,
0.82721,
0.829664,
0.831526,
0.832937,
0.834006,
0.834817,
0.835431,
0.835898,
0.836251,
0.836519,
0.836722,
0.836876,
0.836992,
0.837081,
0.837148,
0.837199,
0.837237,
0.837266,
0.837289,
0.837305,
0.837318,
0.837328,
0.837335,
0.837341,
0.837345,
0.837348,
0.83735,
0.837352,
0.837354,
0.837355,
0.837356,
0.837356,
0.837357,
0.837357,
0.837357,
0.837357,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.837358,
0.835959,
0.81732,
0.801397,
0.787696,
0.775947,
0.765881,
0.757276,
0.749881,
0.74346,
0.737919,
0.733166,
0.729109,
0.725654,
0.722709,
0.720182,
0.71802,
0.716152,
0.714518,
0.713099,
0.711875,
0.710828,
0.709936,
0.709181,
0.708544,
0.708003,
0.707541,
0.707137,
0.706786,
0.70648,
0.706216,
0.70599,
0.705796,
0.705631,
0.70549,
0.705369,
0.705265,
0.705175,
0.705097,
0.705031,
0.704974,
0.704925,
0.673907,
0.644253,
0.615904,
0.588803,
0.562894,
0.538126,
0.514446,
0.491809,
0.470169,
]

n = np.array(n_vector,dtype=float)

t = np.linspace(0,24,240)

# Set the light schedule (timings and intensities)
def light(t):
    full_light = 1000
    dim_light = 300 # reduced light
    wake_time = 7
    sleep_time = 23
    sun_up = 8
    sun_down = 19

    is_awake = np.mod(t - wake_time,24) <= np.mod(sleep_time - wake_time,24)
    sun_is_up = np.mod(t - sun_up,24) <= np.mod(sun_down - sun_up,24)

    return is_awake*(full_light*sun_is_up + dim_light*(1 - sun_is_up))


# Define the alpha(L) function 
def alpha0(t):
    """A helper function for modeling the light input processing"""
    return(alpha_0*pow(light(t), p)/(pow(light(t), p)+I_0));


Bhat = G*(1.0-n)*alpha0(t)

tmp = 1 - m*Bhat



S = not(H1 < 0.001 and tmp < 0)

#S = np.piecewise(tmp, [tmp >= 0, tmp < 0 and H1 < 0.001], [1, 0])


# and H1 < 0.001

plt.plot(t,H1)
plt.show()
plt.plot(t,n)
plt.show()
plt.plot(t,S)
plt.show()

plt.plot(t,H1)
plt.plot(t,S*50)